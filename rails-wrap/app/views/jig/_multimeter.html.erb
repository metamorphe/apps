<script>
// Multimeter.js

Multimeter.modes = {
	resistance: {"image": "/resistanceMode.png"},
	voltage: {"image": "/voltageMode.png"},
	continuity: {"image": "/continuityMode.png"},
}

function Multimeter(dom){
	this.dom = dom;
	this.probes = {
		a: new paper.Path.Circle({
			position: paper.view.center.clone(), 
			fillColor: "red", 
			radius: 3, 
			terminal_helper: true
		}), 
		b: new paper.Path.Circle({
			position: paper.view.center.clone(), 
			fillColor: "black", 
			radius: 3, 
			terminal_helper: true
		})
	}
	this.hide();
}

Multimeter.prototype = {
	show: function(mode, probeA, probeB){
		console.log('SHOWING Multimeter', mode);
		var modeImage = Multimeter.modes[mode].image;
		this.dom.find('img').attr('src', modeImage);
		this.probes.a.position = probeA;
		this.probes.b.position = probeB;
		this.dom.fadeIn();
		paper.project.activeLayer.addChildren([this.probes.a, this.probes.b]);
		paper.view.update();
	}, 
	hide: function(){
		this.dom.fadeOut();
		if(this.probes.a) this.probes.a.remove();
		if(this.probes.b) this.probes.b.remove();
		paper.view.update();
	}
}
var multimeter;
$(function(){
	multimeter = new Multimeter($('#multimeter_holder'));
	probeB = paper.view.center.clone();
	probeB.x += 20;
});
</script>


<div id="multimeter_holder">
	<img src="/voltageMode.png"/>
</div>

<style type="text/css">
	#multimeter_holder{
		position: absolute;
		top: 100px;
		right: 20%;
		z-index: 10000;
		width: 200px;
	    pointer-events: none; 
	}
	#multimeter_holder img{
		width: 100%;
	}
</style>